
<div class="hey">
<div class="toy-list">

  <div class="toy-filter">
    <%= search_form_for(@q, class: "toy-filter form-inline") do |f| %>
      <div class="form-group">
        <label>Buscar pelo título</label>
        <%= f.text_field :title_cont, :class=> "form-control" %>
      </div>
      <div class="form-group within">
        <label>Distância</label>
        <%= text_field_tag :within, (50 || params[:within]), class: "form-control" %> km
      </div>
      <div class="form-group city">
        <label>Cidade</label>
        <%= text_field_tag :city, (params[:city] || lookup_ip_location.city), class: "form-control" %>
      </div>
      <div class="form-group">
        <label>Faixa etária</label>
        <%= f.select(:toy_age_id_eq, options_from_collection_for_select(ToyAge.order("title ASC"), "id", "title", (params[:q][:toy_age_id_eq] if !params[:q].blank?)), {include_blank: "Todas"}, :class=> "form-control" ) %>
      </div>
      <div class="form-group">
        <label>Categoria</label>
        <%= f.select(:toy_category_id_eq, options_from_collection_for_select(ToyCategory.order("title ASC"), "id", "title", (params[:q][:toy_category_id_eq] if !params[:q].blank?)), {include_blank: "Todas"}, :class=> "form-control" ) %>
      </div>
      <div class="form-group">
        <br>
        <%= f.submit "Fitrar", :class => "btn btn-default" %>
      </div>
    <% end %>
  </div>

  <div class="toy-content">

  <div class="pull-right">
    Ordenar por:
    <%= sort_link @q, :created_at, 'mais recentes', default_order: :desc %> |
    <%= sort_link @q, :title, 'ordem alfabética' %>
  </div>
  
  <% if @toys %>
    <div class="lead">
      Mostrando <strong><%= Toy.default_per_page >= @toys.size ? @toys.size : Toy.default_per_page %></strong> de <%= @toys.total_count %> brinquedos
    </div>

    <ul class="cards list-unstyled">
      <%= render @toys %>
    </ul>
  <% else %>
    Nada pra mostrar
  <% end %>
  

  <div class="clearfix"></div>

  <div class="text-center">
    <%= link_to_next_page @toys, 'Veja mais', remote: true, id: "load_more_link", class: "btn btn-default btn-default" %>
  </div>
  </div>
</div>
<div class="toy-map">

  <div id="map_wrapper">
    <div id="map_canvas" class="mapping"></div>
  </div>

  <p class="lead hide">
    <span class="user-location-lat"><%= lookup_ip_location.latitude if lookup_ip_location %></span>
    <span class="user-location-lon"><%= lookup_ip_location.longitude if lookup_ip_location %></span>
  </p>

</div>
</div>

<div class="clearfix"></div>


<div class="hide">
  <p class="lead">Refine sua busca</p>

  <%= search_form_for(@q, class: "toy-filter") do |f| %>

    <div class="form-group">
      <label>Buscar por:</label>
      <%= f.text_field :title_cont, :class=> "form-control" %>
    </div>

    <div class="form-group">
      <label>Faixa etária:</label>
      <% ToyAge.all.each do |cat| %>

        <div class="checkbox" style="margin:0;"><label style="font-size: 11px;min-height:15px;">
          <%# f.check_box :toy_age_id_in, {}, cat.id, true, false %>
          <%= check_box_tag('q[toy_age_id_in][]', cat.id, params[:q] && params[:q][:toy_age_id_in] && params[:q][:toy_age_id_in].include?(cat.id.to_s) ? params[:q][:toy_age_id_in] : nil ) %>
          <%= cat.title %>
        </label></div>
      <% end %>
    </div>

    <div class="form-group">
      <label>Categoria:</label>
      <% ToyCategory.all.each do |cat| %>

        <div class="checkbox" style="margin:0;"><label style="font-size: 11px;min-height:15px;">
          <%= check_box_tag('q[toy_category_id_in][]', cat.id, params[:q] && params[:q][:toy_category_id_in] && params[:q][:toy_category_id_in].include?(cat.id.to_s) ? params[:q][:toy_category_id_in] : nil ) %>
          <%= cat.title %>
        </label></div>
      <% end %>
      <%# f.select(:toy_category_id_eq, options_from_collection_for_select(ToyCategory.all, "id", "title", (params[:q][:toy_category_id_eq] if !params[:q].blank?)), {include_blank: "Selecione..."}, :class=> "form-control" ) %>
    </div>

    <div class="form-group">
      <%= f.submit "Fitrar", :class => "btn btn-primary" %>
    </div>

    <br>
    <br>
    <%= link_to 'Cadastrar brinquedo', new_toy_path, class: "btn btn-default" %>
  <% end %>
</div>
