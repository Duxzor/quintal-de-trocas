<div class="row">
  <div class="col-sm-3">
    <%= render '/layouts/nav_dashboard' %>
  </div>
  <div class="col-sm-9">


    <div class="page-header">
      <h1>Minhas trocas</h1>
    </div>

    <table class="table">
      <thead>
        <tr>
          <th width="45%">Detalhes</th>
          <th width="40%">Status</th>
          <th width="15%" class="text-right">Data</th>
        </tr>
      </thead>

      <tbody>
        <% @exchanges.each do |exchange| %>
          <tr>
            <td>
              <div class="profile-thumb" style="background-image:url('<%= default_img((exchange.user == current_user ? current_user : exchange.user)) %>');float:left;margin-right: 15px;"></div>

              


              <% if exchange.user == current_user %>
                <p class="lead">Solicitação de troca com <%= exchange.toy.user.name %></p>
              <% else %>
                <p class="lead"><%= exchange.user.name %> quer trocar com você</p>
              <% end %>

              <div>
                <span class="text-muted">Brinquedo:</span> <%= link_to exchange.toy.title, exchange_path(exchange) if exchange.toy %>
              </div>
            </td>
            <td>
              <div class="well well-sm text-center">
                <% if exchange.status.blank? %>
                  <% if exchange.user == current_user %>
                    <strong class="lead text-danger">
                      Aguardando resposta de <%= exchange.toy.user.name %>
                    </strong>
                  <% else %>
                    <strong class="lead text-danger">
                      <span class="glyphicon glyphicon-warning-sign"></span> 
                      <%= exchange.user.name %> está aguardando sua resposta
                    </strong>

                    <%= link_to "Responder", "", "data-toggle" => "modal", "data-target" => "#reply", class: "btn btn-link" %>
                    <%= link_to "Aceitar", exchange_toggle_status_path(exchange, status: "sim"), class: "btn btn-sm btn-success", method: :post %>
                    <%= link_to "Recusar", exchange_toggle_status_path(exchange, status: "nao"), class: "btn btn-sm btn-danger", method: :post %>
                  <% end %>
                <% else %>
                  <strong class="lead text-<%= exchange.status == 'sim' ? 'success' : 'danger' %>">
                    <span class="glyphicon glyphicon-ok"></span> Você <%= exchange.status == "sim" ? "aceitou" : "recusou" %> essa troca
                  </strong>
                  
                  <%= link_to 'Ver detalhes', exchange %>
                <% end %>
              </div>
            </td>
            <td class="hide">
              <% if exchange.user == current_user %>
                <span class="label label-danger"><span class="glyphicon glyphicon-arrow-right"></span> Troca solicitada</span>
              <% else %>
                <span class="label label-success"><span class="glyphicon glyphicon-arrow-left"></span> Troca recebida</span>
              <% end %>
            </td>
            <td class="text-right">
              <%= exchange.created_at.strftime("%d/%m/%Y") %>
            </td>
          </tr>
        <% end %>
      </tbody>
    </table>

  </div>
</div>

<!-- Modal -->
<div class="modal fade" id="reply" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title" id="myModalLabel">Modal title</h4>
      </div>
      <div class="modal-body" style="background-color: #f6f6f6;">

        <p class="lead text-center" style="margin: 15px 0 30px 0;">Escolha um dos brinquedos da lista ou troque por 1 crédito. 1 crédito vale um brinquedo dentro da plataforma.</p>

        <div class="row">
          <div class="col-sm-7">
            <ul class="list-group user-toy-list" style="overflow: scroll;height: 200px;">
              <li class="list-group-item">kkokokok</li>
              <li class="list-group-item">kkokokok</li>
              <li class="list-group-item">kkokokok</li>
              <li class="list-group-item">kkokokok</li>
              <li class="list-group-item">kkokokok</li>
              <li class="list-group-item">kkokokok</li>
            </ul>
          </div>
          <div class="col-sm-5 text-center">
            <br>
            <br>
            <p class="lead">Prefiro trocar por<br>1 crédito</p>
          </div>
        </div>

      </div>
      <div class="modal-footer">
        <div class="text-center">
          <%= link_to "Prosseguir &raquo;".html_safe, "#", class: "btn btn-lg btn-success" %>
        </div>
      </div>
    </div>
  </div>
</div>
